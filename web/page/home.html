<!DOCTYPE html>
<html lang="en" class="h-screen" style="background-image: linear-gradient(to left bottom, #22043b, #36326b, #4a609a, #6290c7, #81c2f3);">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="cleartype" content="on">	
	<title>Portfolio - Artax01</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="max-w-7xl mx-auto p-6 bg-gray-100 mt-6 text-gray-800 rounded-xl">
	<header class="px-6 pt-6">
		<div class="flex flex-row space-x-6 items-center mb-4">
			<img id="avatar" src="" alt="" class="w-24 h-24 rounded-full border-4 border-indigo-400 shadow-lg">
			<div>
				<h1 id="username" class="text-2xl font-bold"></h1>
				<p id="followers"></p>
				<p id="location"></p>
			</div>
		</div>
		<p id="bio" class="p-2 font-semibold">Student & Developer.</p>
	</header>

	<section class="p-6 flex flex-col sm:flex-row gap-4 items-center justify-between">
		<input id="search" type="text" placeholder="üîç Search for a project..." class="w-full sm:w-1/3 px-4 py-2 border rounded-xl focus:ring focus:ring-indigo-200">

		<select id="languageFilter" class="px-4 py-2 border rounded-xl">
			<option value="">üåê All languages</option>
		</select>

		<select id="sort" class="px-4 py-2 border rounded-xl">
			<option value="updated">‚è∞ Last update</option>
			<option value="stars">‚≠ê Most starred</option>
		</select>
	</section>

	<main id="projects" class="grid gap-6 p-6 sm:grid-cols-2 lg:grid-cols-3"></main>
	
  	<script>
		const username = "artax01";
		const container = document.getElementById("projects");
		const searchInput = document.getElementById("search");
		const languageFilter = document.getElementById("languageFilter");
		const sortSelect = document.getElementById("sort");
		let allRepos = [];

		async function fetchProfile() {
			const response = await fetch(`https://api.github.com/users/${username}`);
			const user = await response.json();

			document.getElementById("avatar").src = user.avatar_url;
			document.getElementById("username").textContent = `${user.name} (${user.login})`;
			document.getElementById("followers").textContent = `üë• ${user.followers} Followers`;
			document.getElementById("location").textContent = `üìç ${user.location}`;
			// document.getElementById("bio").textContent = user.bio || "";
		}

		async function fetchRepos() {
			const response = await fetch(`https://api.github.com/users/${username}/repos?per_page=100`);
			allRepos = await response.json();
			if (allRepos.message) {
				container.innerHTML = "<p class='text-center col-span-full'>No repository found.</p>";
				return;
			}
			renderRepos();
			completeLanguageFilter();
		}

		function renderRepos() {
			container.innerHTML = "";

			let repos = [...allRepos];
			
			// partie pour trier en fonction de la recherche
			try {
				const query = searchInput.value.toLowerCase();
				if (query) {
					repos = repos.filter(repo => repo.name.toLowerCase().includes(query) || (repo.description && repo.description.toLowerCase().includes(query)));
				}
			} catch (e) {
				console.error("Search error:", e);
			}

			// partie pour trier par langage
			try {
				const selectedLang = languageFilter.value;
				if (selectedLang) {
					repos = repos.filter(repo => repo.language === selectedLang);
				}
			} catch (e) {
				console.error("Language filtering error:", e);
			}

			// partie pour trier en fonction du nombre d'√©toiles ou de la date de mise √† jour
			try {
				const sortBy = sortSelect.value;
				if (sortBy === "stars") {
					repos.sort((a, b) => b.stargazers_count - a.stargazers_count);
				} else {
					repos.sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at));
				}
			} catch (e) {
				console.error("Repository sorting error:", e);
			}

			repos.forEach(repo => {
				const card = document.createElement("div");
				card.className = "bg-white rounded-2xl shadow p-6 hover:shadow-lg transition";

				card.innerHTML = `
				<h2 class="text-xl font-semibold mb-2">
					<a href="${repo.html_url}" target="_blank" class="text-indigo-600 hover:underline">${repo.name}</a>
				</h2>
				<p class="text-gray-600 mb-4">${repo.description || "No description."}</p>
				<div class="flex justify-between text-sm text-gray-500">
					<span>‚≠ê ${repo.stargazers_count}</span>
					<span>üç¥ ${repo.forks_count}</span>
					<span>üíª ${repo.language || "N/A"}</span>
				</div>
				`;
				container.appendChild(card);
			});
		}

		// partie pour ajouter les langages comme option dans le filtre
		function completeLanguageFilter() {
			const langs = [...new Set(allRepos.map(r => r.language).filter(Boolean))];
			langs.sort();
			langs.forEach(lang => {
				const option = document.createElement("option");
				option.value = lang;
				option.textContent = lang;
				languageFilter.appendChild(option);
			});
		}
		searchInput.addEventListener("input", renderRepos);
		languageFilter.addEventListener("change", renderRepos);
		sortSelect.addEventListener("change", renderRepos);

		fetchProfile();
		fetchRepos();
  	</script>
</body>
</html>